// Este fichero se le da al alumno
#include <stdio.h>
#include "fichero.h"
#include <math.h>

#define SIZE_NOMBRE_FICHERO	  80
#define DIM 36

typedef struct {
 char sudoku[DIM][DIM];
 int size;
 int ssize;
 int ocupadas;
 int libres;
 int totales;
} tsudoku;


tsudoku leer_sudoku();
void linea_h (int size);
void linea_vacia (tsudoku s, int fila);
char convertir_char (int i);
void mostrar_sudoku(tsudoku s);

int main() {
	tsudoku s;
	
	s = leer_sudoku();
	mostrar_sudoku(s);
}

tsudoku leer_sudoku()
{
  int err, f, c, size, car, num1, i, j;
        tsudoku s;
	char nombre_fichero[SIZE_NOMBRE_FICHERO];

 s.ocupadas = 0;
 
 s.libres = 0;
 num1 = 0;

	printf("Introduce el nombre del fichero: ");
	scanf("%s%*c", nombre_fichero);
	err = abrir_fichero(nombre_fichero);
	if (err != ABRIR_FICHERO_OK) {
		printf("ERROR: FICHERO NO ENCONTRADO.\n");
		printf("PUEDE QUE EL NOMBRE NO SEA EL CORRECTO O QUE ESTE EN OTRO DIRECTORIO.\n");
	} else {
		s.size = leer_int_fichero();
		s.ssize = sqrt(s.size);
		leer_char_fichero(); // '\n'

		//printf("Sudoku %dx%d\n\n", s.size, s.size);
		for (f = 0; f < s.size; f++) {
			for (c = 0; c < s.size; c++) {
				car = leer_char_fichero();
				//printf("%c ", car);
			}
      if (car >= '1' && car <= s.size) {
        s.ocupadas++;
      } else if (car == ' ') {
        s.libres++;
      }
			leer_char_fichero(); // '\n'
		}
  printf("\n");
  s.totales = s.size * s.size;
		cerrar_fichero();
	}
	
 return s;
}
void mostrar_sudoku(tsudoku s)
{
  int f,c, aux, k;
 printf(" ");
  for(c = 0; c < s.size; c++){
    aux = c % (s.ssize);
    if( aux== 0){
      printf("|%d ",c);
    }else if((aux + 1) % 3 == 0){
      printf("%d", c);
    } else 
      printf("%d ", c);
  }
  printf("|\n");

  for(f = 0; f < s.size; f++) {
  if(f % (s.ssize) == 0){
    linea_h (s.size);
    for(k = 0; k < s.ssize; k++){
   linea_vacia (s, f + k);
  }
  }
  }
  linea_h (s.size);
  /*
  for(c = 0; c < s.size; c++){
   if(c % (s.ssize) == 0){
    printf("|");
   }else{
     printf(" ");
   }
   printf("%c", s.sudoku[f][c]); 
  }
  printf("\n");
} */

}
void linea_h (int size) {
 int f,c; 
    printf("-");
     for(c = 0; c < (size * 2); c = c +2){
       printf("+-");
     }
     printf("+\n"); 
  }   
void linea_vacia (tsudoku s, int fila){
int c;
printf("%d|", fila + 1); 
for (c = 0; c < s.size*2; c++){
 if (c % (s.ssize*2) == 0){
    printf("     |");   
 }
}
printf("\n");
}
char convertir_char (int i) {
 char c;
 if (i < 10){
  c = i + '0';
 }else{
  c = i + 87;
 } 
 return c;
}

 


